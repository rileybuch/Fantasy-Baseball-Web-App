SET GLOBAL local_infile = 'ON';
CREATE SCHEMA dbo;
USE dbo;
CREATE TABLE dbo.Batting(
Season INTEGER
,Name VARCHAR(64)
,HR INTEGER
,TB INTEGER
,R INTEGER
,RBI INTEGER
,SB INTEGER
,AVG DECIMAL(10,4)
,OBP DECIMAL(10,4)
,SLG DECIMAL(10,4)
,key_mlbam INTEGER
,overall_risk INTEGER
,HRvL INTEGER
,HRvH INTEGER
,HRrL INTEGER
,HRrM INTEGER
,HRrH INTEGER
,TBvL INTEGER
,TBvH INTEGER
,TBrL INTEGER
,TBrM INTEGER
,TBrH INTEGER
,RvL INTEGER
,RvH INTEGER
,RrL INTEGER
,RrM INTEGER
,RrH INTEGER
,RBIvL INTEGER
,RBIvH INTEGER
,RBIrL INTEGER
,RBIrM INTEGER
,RBIrH INTEGER
,SBvL INTEGER
,SBvH INTEGER
,SBrL INTEGER
,SBrM INTEGER
,SBrH INTEGER
,AVGvL DECIMAL(10,4)
,AVGvH DECIMAL(10,4)
,AVGrL INTEGER
,AVGrM INTEGER
,AVGrH INTEGER
,OBPvL DECIMAL(10,4)
,OBPvH DECIMAL(10,4)
,OBPrL INTEGER
,OBPrM INTEGER
,OBPrH INTEGER
,SLGvL DECIMAL(10,4)
,SLGvH DECIMAL(10,4)
,SLGrL INTEGER
,SLGrM INTEGER
,SLGrH INTEGER
,G INTEGER);

CREATE TABLE dbo.Pitching(
Season INTEGER
,Name VARCHAR(64)
,Age INTEGER
,W INTEGER
,L INTEGER
,ERA DECIMAL(10,4)
,SV INTEGER
,IP DECIMAL(10,4)
,HR INTEGER
,SO INTEGER
,WHIP DECIMAL(10,4)
,key_mlbam INTEGER
,overall_risk INTEGER
,WvL INTEGER
,WvH INTEGER
,WrL INTEGER
,WrM INTEGER
,WrH INTEGER
,LvL INTEGER
,LvH INTEGER
,LrL INTEGER
,LrM INTEGER
,LrH INTEGER
,ERAvL DECIMAL(10,4)
,ERAvH DECIMAL(10,4)
,ERArL DECIMAL(10,4)
,ERArM DECIMAL(10,4)
,ERArH DECIMAL(10,4)
,SVvL INTEGER
,SVvH INTEGER
,SVrL INTEGER
,SVrM INTEGER
,SVrH INTEGER
,IPvL DECIMAL(10,4)
,IPvH DECIMAL(10,4)
,IPrL DECIMAL(10,4)
,IPrM DECIMAL(10,4)
,IPrH DECIMAL(10,4)
,HRvL INTEGER
,HRvH INTEGER
,HRrL INTEGER
,HRrM INTEGER
,HRrH INTEGER
,SOvL INTEGER
,SOvH INTEGER
,SOrL INTEGER
,SOrM INTEGER
,SOrH INTEGER
,WHIPvL DECIMAL(10,4)
,WHIPvH DECIMAL(10,4)
,WHIPrL DECIMAL(10,4)
,WHIPrM DECIMAL(10,4)
,WHIPrH DECIMAL(10,4)
,pitcher_type VARCHAR(16)
,G INTEGER);

LOAD DATA INFILE '/data/batting_1996_2020_risk_calc.csv'
INTO TABLE dbo.Batting
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(@Season,@Name,@HR,@TB,@R,@RBI,@SB,@AVG,@OBP,@SLG,@key_mlbam,@overall_risk,@HRvL,@HRvH,@HRrL,@HRrM,@HRrH,@TBvL,@TBvH,@TBrL,@TBrM,@TBrH,@RvL,@RvH,@RrL,@RrM,@RrH,@RBIvL,@RBIvH,@RBIrL,@RBIrM,@RBIrH,@SBvL,@SBvH,@SBrL,@SBrM,@SBrH,@AVGvL,@AVGvH,@AVGrL,@AVGrM,@AVGrH,@OBPvL,@OBPvH,@OBPrL,@OBPrM,@OBPrH,@SLGvL,@SLGvH,@SLGrL,@SLGrM,@SLGrH,@G)
SET Season = CASE WHEN @Season = '' THEN NULL ELSE @Season END,
Name = CASE WHEN @Name = '' THEN NULL ELSE @Name END,
HR = CASE WHEN @HR = '' THEN NULL ELSE @HR END,
TB = CASE WHEN @TB = '' THEN NULL ELSE @TB END,
R = CASE WHEN @R = '' THEN NULL ELSE @R END,
RBI = CASE WHEN @RBI = '' THEN NULL ELSE @RBI END,
SB = CASE WHEN @SB = '' THEN NULL ELSE @SB END,
AVG = CASE WHEN @AVG = '' THEN NULL ELSE @AVG END,
OBP = CASE WHEN @OBP = '' THEN NULL ELSE @OBP END,
SLG = CASE WHEN @SLG = '' THEN NULL ELSE @SLG END,
key_mlbam = CASE WHEN @key_mlbam = '' THEN NULL ELSE @key_mlbam END,
overall_risk = CASE WHEN @overall_risk = '' THEN NULL ELSE @overall_risk END,
HRvL = CASE WHEN @HRvL = '' THEN NULL ELSE @HRvL END,
HRvH = CASE WHEN @HRvH = '' THEN NULL ELSE @HRvH END,
HRrL = CASE WHEN @HRrL = '' THEN NULL ELSE @HRrL END,
HRrM = CASE WHEN @HRrM = '' THEN NULL ELSE @HRrM END,
HRrH = CASE WHEN @HRrH = '' THEN NULL ELSE @HRrH END,
TBvL = CASE WHEN @TBvL = '' THEN NULL ELSE @TBvL END,
TBvH = CASE WHEN @TBvH = '' THEN NULL ELSE @TBvH END,
TBrL = CASE WHEN @TBrL = '' THEN NULL ELSE @TBrL END,
TBrM = CASE WHEN @TBrM = '' THEN NULL ELSE @TBrM END,
TBrH = CASE WHEN @TBrH = '' THEN NULL ELSE @TBrH END,
RvL = CASE WHEN @RvL = '' THEN NULL ELSE @RvL END,
RvH = CASE WHEN @RvH = '' THEN NULL ELSE @RvH END,
RrL = CASE WHEN @RrL = '' THEN NULL ELSE @RrL END,
RrM = CASE WHEN @RrM = '' THEN NULL ELSE @RrM END,
RrH = CASE WHEN @RrH = '' THEN NULL ELSE @RrH END,
RBIvL = CASE WHEN @RBIvL = '' THEN NULL ELSE @RBIvL END,
RBIvH = CASE WHEN @RBIvH = '' THEN NULL ELSE @RBIvH END,
RBIrL = CASE WHEN @RBIrL = '' THEN NULL ELSE @RBIrL END,
RBIrM = CASE WHEN @RBIrM = '' THEN NULL ELSE @RBIrM END,
RBIrH = CASE WHEN @RBIrH = '' THEN NULL ELSE @RBIrH END,
SBvL = CASE WHEN @SBvL = '' THEN NULL ELSE @SBvL END,
SBvH = CASE WHEN @SBvH = '' THEN NULL ELSE @SBvH END,
SBrL = CASE WHEN @SBrL = '' THEN NULL ELSE @SBrL END,
SBrM = CASE WHEN @SBrM = '' THEN NULL ELSE @SBrM END,
SBrH = CASE WHEN @SBrH = '' THEN NULL ELSE @SBrH END,
AVGvL = CASE WHEN @AVGvL = '' THEN NULL ELSE @AVGvL END,
AVGvH = CASE WHEN @AVGvH = '' THEN NULL ELSE @AVGvH END,
AVGrL = CASE WHEN @AVGrL = '' THEN NULL ELSE @AVGrL END,
AVGrM = CASE WHEN @AVGrM = '' THEN NULL ELSE @AVGrM END,
AVGrH = CASE WHEN @AVGrH = '' THEN NULL ELSE @AVGrH END,
OBPvL = CASE WHEN @OBPvL = '' THEN NULL ELSE @OBPvL END,
OBPvH = CASE WHEN @OBPvH = '' THEN NULL ELSE @OBPvH END,
OBPrL = CASE WHEN @OBPrL = '' THEN NULL ELSE @OBPrL END,
OBPrM = CASE WHEN @OBPrM = '' THEN NULL ELSE @OBPrM END,
OBPrH = CASE WHEN @OBPrH = '' THEN NULL ELSE @OBPrH END,
SLGvL = CASE WHEN @SLGvL = '' THEN NULL ELSE @SLGvL END,
SLGvH = CASE WHEN @SLGvH = '' THEN NULL ELSE @SLGvH END,
SLGrL = CASE WHEN @SLGrL = '' THEN NULL ELSE @SLGrL END,
SLGrM = CASE WHEN @SLGrM = '' THEN NULL ELSE @SLGrM END,
SLGrH = CASE WHEN @SLGrH = '' THEN NULL ELSE @SLGrH END,
G = CASE WHEN @G = '' THEN NULL ELSE @G END;

LOAD DATA INFILE '/data/relievers_1996_2020_risk_calc.csv'
INTO TABLE dbo.Pitching
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(@Season,@Name,@Age,@W,@L,@ERA,@SV,@IP,@HR,@SO,@WHIP,@key_mlbam,@overall_risk,@WvL,@WvH,@WrL,@WrM,@WrH,@LvL,@LvH,@LrL,@LrM,@LrH,@ERAvL,@ERAvH,@ERArL,@ERArM,@ERArH,@SVvL,@SVvH,@SVrL,@SVrM,@SVrH,@IPvL,@IPvH,@IPrL,@IPrM,@IPrH,@HRvL,@HRvH,@HRrL,@HRrM,@HRrH,@SOvL,@SOvH,@SOrL,@SOrM,@SOrH,@WHIPvL,@WHIPvH,@WHIPrL,@WHIPrM,@WHIPrH,@G)
SET Season = CASE WHEN @Season = '' THEN NULL ELSE @Season END,
Name = CASE WHEN @Name = '' THEN NULL ELSE @Name END,
Age = CASE WHEN @Age = '' THEN NULL ELSE @Age END,
W = CASE WHEN @W = '' THEN NULL ELSE @W END,
L = CASE WHEN @L = '' THEN NULL ELSE @L END,
ERA = CASE WHEN @ERA = '' THEN NULL ELSE @ERA END,
SV = CASE WHEN @SV = '' THEN NULL ELSE @SV END,
IP = CASE WHEN @IP = '' THEN NULL ELSE @IP END,
HR = CASE WHEN @HR = '' THEN NULL ELSE @HR END,
SO = CASE WHEN @SO = '' THEN NULL ELSE @SO END,
WHIP = CASE WHEN @WHIP = '' THEN NULL ELSE @WHIP END,
key_mlbam = CASE WHEN @key_mlbam = '' THEN NULL ELSE @key_mlbam END,
overall_risk = CASE WHEN @overall_risk = '' THEN NULL ELSE @overall_risk END,
WvL = CASE WHEN @WvL = '' THEN NULL ELSE @WvL END,
WvH = CASE WHEN @WvH = '' THEN NULL ELSE @WvH END,
WrL = CASE WHEN @WrL = '' THEN NULL ELSE @WrL END,
WrM = CASE WHEN @WrM = '' THEN NULL ELSE @WrM END,
WrH = CASE WHEN @WrH = '' THEN NULL ELSE @WrH END,
LvL = CASE WHEN @LvL = '' THEN NULL ELSE @LvL END,
LvH = CASE WHEN @LvH = '' THEN NULL ELSE @LvH END,
LrL = CASE WHEN @LrL = '' THEN NULL ELSE @LrL END,
LrM = CASE WHEN @LrM = '' THEN NULL ELSE @LrM END,
LrH = CASE WHEN @LrH = '' THEN NULL ELSE @LrH END,
ERAvL = CASE WHEN @ERAvL = '' THEN NULL ELSE @ERAvL END,
ERAvH = CASE WHEN @ERAvH = '' THEN NULL ELSE @ERAvH END,
ERArL = CASE WHEN @ERArL = '' THEN NULL ELSE @ERArL END,
ERArM = CASE WHEN @ERArM = '' THEN NULL ELSE @ERArM END,
ERArH = CASE WHEN @ERArH = '' THEN NULL ELSE @ERArH END,
SVvL = CASE WHEN @SVvL = '' THEN NULL ELSE @SVvL END,
SVvH = CASE WHEN @SVvH = '' THEN NULL ELSE @SVvH END,
SVrL = CASE WHEN @SVrL = '' THEN NULL ELSE @SVrL END,
SVrM = CASE WHEN @SVrM = '' THEN NULL ELSE @SVrM END,
SVrH = CASE WHEN @SVrH = '' THEN NULL ELSE @SVrH END,
IPvL = CASE WHEN @IPvL = '' THEN NULL ELSE @IPvL END,
IPvH = CASE WHEN @IPvH = '' THEN NULL ELSE @IPvH END,
IPrL = CASE WHEN @IPrL = '' THEN NULL ELSE @IPrL END,
IPrM = CASE WHEN @IPrM = '' THEN NULL ELSE @IPrM END,
IPrH = CASE WHEN @IPrH = '' THEN NULL ELSE @IPrH END,
HRvL = CASE WHEN @HRvL = '' THEN NULL ELSE @HRvL END,
HRvH = CASE WHEN @HRvH = '' THEN NULL ELSE @HRvH END,
HRrL = CASE WHEN @HRrL = '' THEN NULL ELSE @HRrL END,
HRrM = CASE WHEN @HRrM = '' THEN NULL ELSE @HRrM END,
HRrH = CASE WHEN @HRrH = '' THEN NULL ELSE @HRrH END,
SOvL = CASE WHEN @SOvL = '' THEN NULL ELSE @SOvL END,
SOvH = CASE WHEN @SOvH = '' THEN NULL ELSE @SOvH END,
SOrL = CASE WHEN @SOrL = '' THEN NULL ELSE @SOrL END,
SOrM = CASE WHEN @SOrM = '' THEN NULL ELSE @SOrM END,
SOrH = CASE WHEN @SOrH = '' THEN NULL ELSE @SOrH END,
WHIPvL = CASE WHEN @WHIPvL = '' THEN NULL ELSE @WHIPvL END,
WHIPvH = CASE WHEN @WHIPvH = '' THEN NULL ELSE @WHIPvH END,
WHIPrL = CASE WHEN @WHIPrL = '' THEN NULL ELSE @WHIPrL END,
WHIPrM = CASE WHEN @WHIPrM = '' THEN NULL ELSE @WHIPrM END,
WHIPrH = CASE WHEN @WHIPrH = '' THEN NULL ELSE @WHIPrH END,
pitcher_type = 'Reliever',
G = CASE WHEN @G = '' THEN NULL ELSE @G END;

LOAD DATA INFILE '/data/starters_1996_2020_risk_calc.csv'
INTO TABLE dbo.Pitching
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(@Season,@Name,@Age,@W,@L,@ERA,@SV,@IP,@HR,@SO,@WHIP,@key_mlbam,@overall_risk,@WvL,@WvH,@WrL,@WrM,@WrH,@LvL,@LvH,@LrL,@LrM,@LrH,@ERAvL,@ERAvH,@ERArL,@ERArM,@ERArH,@SVvL,@SVvH,@SVrL,@SVrM,@SVrH,@IPvL,@IPvH,@IPrL,@IPrM,@IPrH,@HRvL,@HRvH,@HRrL,@HRrM,@HRrH,@SOvL,@SOvH,@SOrL,@SOrM,@SOrH,@WHIPvL,@WHIPvH,@WHIPrL,@WHIPrM,@WHIPrH,@G)
SET Season = CASE WHEN @Season = '' THEN NULL ELSE @Season END,
Name = CASE WHEN @Name = '' THEN NULL ELSE @Name END,
Age = CASE WHEN @Age = '' THEN NULL ELSE @Age END,
W = CASE WHEN @W = '' THEN NULL ELSE @W END,
L = CASE WHEN @L = '' THEN NULL ELSE @L END,
ERA = CASE WHEN @ERA = '' THEN NULL ELSE @ERA END,
SV = CASE WHEN @SV = '' THEN NULL ELSE @SV END,
IP = CASE WHEN @IP = '' THEN NULL ELSE @IP END,
HR = CASE WHEN @HR = '' THEN NULL ELSE @HR END,
SO = CASE WHEN @SO = '' THEN NULL ELSE @SO END,
WHIP = CASE WHEN @WHIP = '' THEN NULL ELSE @WHIP END,
key_mlbam = CASE WHEN @key_mlbam = '' THEN NULL ELSE @key_mlbam END,
overall_risk = CASE WHEN @overall_risk = '' THEN NULL ELSE @overall_risk END,
WvL = CASE WHEN @WvL = '' THEN NULL ELSE @WvL END,
WvH = CASE WHEN @WvH = '' THEN NULL ELSE @WvH END,
WrL = CASE WHEN @WrL = '' THEN NULL ELSE @WrL END,
WrM = CASE WHEN @WrM = '' THEN NULL ELSE @WrM END,
WrH = CASE WHEN @WrH = '' THEN NULL ELSE @WrH END,
LvL = CASE WHEN @LvL = '' THEN NULL ELSE @LvL END,
LvH = CASE WHEN @LvH = '' THEN NULL ELSE @LvH END,
LrL = CASE WHEN @LrL = '' THEN NULL ELSE @LrL END,
LrM = CASE WHEN @LrM = '' THEN NULL ELSE @LrM END,
LrH = CASE WHEN @LrH = '' THEN NULL ELSE @LrH END,
ERAvL = CASE WHEN @ERAvL = '' THEN NULL ELSE @ERAvL END,
ERAvH = CASE WHEN @ERAvH = '' THEN NULL ELSE @ERAvH END,
ERArL = CASE WHEN @ERArL = '' THEN NULL ELSE @ERArL END,
ERArM = CASE WHEN @ERArM = '' THEN NULL ELSE @ERArM END,
ERArH = CASE WHEN @ERArH = '' THEN NULL ELSE @ERArH END,
SVvL = CASE WHEN @SVvL = '' THEN NULL ELSE @SVvL END,
SVvH = CASE WHEN @SVvH = '' THEN NULL ELSE @SVvH END,
SVrL = CASE WHEN @SVrL = '' THEN NULL ELSE @SVrL END,
SVrM = CASE WHEN @SVrM = '' THEN NULL ELSE @SVrM END,
SVrH = CASE WHEN @SVrH = '' THEN NULL ELSE @SVrH END,
IPvL = CASE WHEN @IPvL = '' THEN NULL ELSE @IPvL END,
IPvH = CASE WHEN @IPvH = '' THEN NULL ELSE @IPvH END,
IPrL = CASE WHEN @IPrL = '' THEN NULL ELSE @IPrL END,
IPrM = CASE WHEN @IPrM = '' THEN NULL ELSE @IPrM END,
IPrH = CASE WHEN @IPrH = '' THEN NULL ELSE @IPrH END,
HRvL = CASE WHEN @HRvL = '' THEN NULL ELSE @HRvL END,
HRvH = CASE WHEN @HRvH = '' THEN NULL ELSE @HRvH END,
HRrL = CASE WHEN @HRrL = '' THEN NULL ELSE @HRrL END,
HRrM = CASE WHEN @HRrM = '' THEN NULL ELSE @HRrM END,
HRrH = CASE WHEN @HRrH = '' THEN NULL ELSE @HRrH END,
SOvL = CASE WHEN @SOvL = '' THEN NULL ELSE @SOvL END,
SOvH = CASE WHEN @SOvH = '' THEN NULL ELSE @SOvH END,
SOrL = CASE WHEN @SOrL = '' THEN NULL ELSE @SOrL END,
SOrM = CASE WHEN @SOrM = '' THEN NULL ELSE @SOrM END,
SOrH = CASE WHEN @SOrH = '' THEN NULL ELSE @SOrH END,
WHIPvL = CASE WHEN @WHIPvL = '' THEN NULL ELSE @WHIPvL END,
WHIPvH = CASE WHEN @WHIPvH = '' THEN NULL ELSE @WHIPvH END,
WHIPrL = CASE WHEN @WHIPrL = '' THEN NULL ELSE @WHIPrL END,
WHIPrM = CASE WHEN @WHIPrM = '' THEN NULL ELSE @WHIPrM END,
WHIPrH = CASE WHEN @WHIPrH = '' THEN NULL ELSE @WHIPrH END,
pitcher_type = 'Starter',
G = CASE WHEN @G = '' THEN NULL ELSE @G END;
